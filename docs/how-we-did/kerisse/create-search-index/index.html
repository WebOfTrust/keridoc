<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-how-we-did/kerisse/create-search-index" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.5.2">
<title data-rh="true">Create a search index | KERIDoc</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://weboftrust.github.io/keridoc/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://weboftrust.github.io/keridoc/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://weboftrust.github.io/keridoc/docs/how-we-did/kerisse/create-search-index"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Create a search index | KERIDoc"><meta data-rh="true" name="description" content="Instructions plus background."><meta data-rh="true" property="og:description" content="Instructions plus background."><link data-rh="true" rel="icon" href="/keridoc/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://weboftrust.github.io/keridoc/docs/how-we-did/kerisse/create-search-index"><link data-rh="true" rel="alternate" href="https://weboftrust.github.io/keridoc/docs/how-we-did/kerisse/create-search-index" hreflang="en"><link data-rh="true" rel="alternate" href="https://weboftrust.github.io/keridoc/docs/how-we-did/kerisse/create-search-index" hreflang="x-default"><script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.min.js"></script><link rel="stylesheet" href="/keridoc/assets/css/styles.8ab56fd5.css">
<script src="/keridoc/assets/js/runtime~main.79136d9c.js" defer="defer"></script>
<script src="/keridoc/assets/js/main.37cca4d4.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/keridoc/"><div class="navbar__logo"><img src="/keridoc/img/logo-keri-symbol.png" alt="KERIDoc Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/keridoc/img/logo-keri-symbol.png" alt="KERIDoc Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Home</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/keridoc/docs/intro/intro">Enter documentation</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/keridoc/docs/how-we-did/keridoc/cheat-sheet-writing-page">For contributors to this website</a><a class="navbar__item navbar__link" href="/keridoc/feedback">Feedback</a><a href="https://weboftrust.github.io/keridoc/slack/html/" target="_self" rel="noopener noreferrer" class="navbar__item navbar__link">Slack history</a></div><div class="navbar__items navbar__items--right"><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/keridoc/docs/intro/intro">KERIDoc</a><a href="https://weboftrust.github.io/WOT-terms/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">KERIGlos<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://weboftrust.github.io/kerisse/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">KERISSE<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://github.com/weboftrust/keridoc" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub repo<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="navbar__search searchBarContainer_NW3z" dir="ltr"><input placeholder="Search" aria-label="Search" class="navbar__search-input"><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/keridoc/docs/category/intro">Intro</a><button aria-label="Expand sidebar category &#x27;Intro&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/keridoc/docs/category/overview">Overview</a><button aria-label="Expand sidebar category &#x27;Overview&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/keridoc/docs/category/visualisations">Visualisations</a><button aria-label="Expand sidebar category &#x27;Visualisations&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/keridoc/docs/category/resources">Resources</a><button aria-label="Expand sidebar category &#x27;Resources&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/keridoc/docs/category/concepts">Concepts</a><button aria-label="Expand sidebar category &#x27;Concepts&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/keridoc/docs/category/education">Education</a><button aria-label="Expand sidebar category &#x27;Education&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/keridoc/docs/category/annotated-copies">Annotated Copies</a><button aria-label="Expand sidebar category &#x27;Annotated Copies&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/keridoc/docs/dictionary">Dictionary SSI</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/keridoc/docs/github-latest-activity/cesride">github-latest-activity</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/keridoc/docs/category/various-external-glossaries">Various external glossaries</a><button aria-label="Expand sidebar category &#x27;Various external glossaries&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/keridoc/docs/glossary-toip-style/">KERI Suite Glossary in ToIP style</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/keridoc/docs/category/how-we-did">How we did</a><button aria-label="Collapse sidebar category &#x27;How we did&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/keridoc/docs/how-we-did/intro">Intro</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/keridoc/docs/how-we-did/general/install-project-kerisse">general</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/keridoc/docs/how-we-did/glossary/edit-metadata">glossary</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/keridoc/docs/how-we-did/keridoc/cheat-sheet-writing-page">keridoc</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/keridoc/docs/how-we-did/kerific/kerific-browser-extension">kerific</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" tabindex="0" href="/keridoc/docs/how-we-did/kerisse/create-search-index">kerisse</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/keridoc/docs/how-we-did/kerisse/create-search-index">Create a search index</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/keridoc/docs/how-we-did/kerisse/ip-rights-scraping">IP rights of scraped sources</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/keridoc/docs/how-we-did/kerisse/overrides">Overrides</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/keridoc/docs/how-we-did/kerisse/typesense-search-install-config">Typesense search install and configuration</a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/keridoc/docs/category/video">Video</a><button aria-label="Expand sidebar category &#x27;Video&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/keridoc/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/keridoc/docs/category/how-we-did"><span itemprop="name">How we did</span></a><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">kerisse</span><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Create a search index</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Create a search index</h1></header>
<p>Instructions plus background.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="instructions-how-to-add-a-website-to-the-search-index">Instructions: how to add a website to the search index<a href="#instructions-how-to-add-a-website-to-the-search-index" class="hash-link" aria-label="Direct link to Instructions: how to add a website to the search index" title="Direct link to Instructions: how to add a website to the search index">​</a></h2>
<p>To add a website to the search index there are three parts to consider:</p>
<ol>
<li>Obtaining a sitemap.xml</li>
<li>Scraping all the URLs in the sitemap</li>
<li>Importing the content into the search index</li>
</ol>
<p>Everything is done via the terminal (command line).</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="sitemap">Sitemap<a href="#sitemap" class="hash-link" aria-label="Direct link to Sitemap" title="Direct link to Sitemap">​</a></h3>
<p>Find out if the website has a sitemap.xml.</p>
<p>If the website is <code>https://the-website.com</code> then try <code>https://the-website.com/sitemap.xml</code>, if that gives a list with URLs then that is your sitemap. Write it down so you can use it in a moment.</p>
<p>If it does not exist, or you think it is not up to date then make a sitemap via de Kerisse sitemap creator:</p>
<p>Open <code>search-index-typesense/config/config_sitemaps_create.sh</code> and follow the instructions.</p>
<p>There are two sections <em>General websites</em> and <em>Github repos</em>. Use <em>sitemap-generator</em> for a website in general and use the specialized <em>createSitemapGithub.mjs</em> for Github repo&#x27;s.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="scraper">Scraper<a href="#scraper" class="hash-link" aria-label="Direct link to Scraper" title="Direct link to Scraper">​</a></h3>
<p>Now that we have the URLs that we want to scrape, we have to configure the scraper.</p>
<p>Open <code>search-index-typesense/config/configScraperGenericSitemaps.mjs</code>.</p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>For every website there is a config object and a function. Every function has to be exported. This is not very user-friendly, and will change in the future.</p></div></div>
<p>Now go to the main menu:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sh search-index-typesense/main.sh</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Choose option [1] Scrape all sites</p>
<p>It can take a long time before the scraper finishes. The terminal will output what is happening.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="import">Import<a href="#import" class="hash-link" aria-label="Direct link to Import" title="Direct link to Import">​</a></h3>
<p>After the scrape session has finished, go to the main menu again:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sh search-index-typesense/main.sh</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>and choose option [3] Import</p>
<p>Now the new content will be imported into the Typesense system (in the cloud).</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="additional-config-options">Additional config options<a href="#additional-config-options" class="hash-link" aria-label="Direct link to Additional config options" title="Direct link to Additional config options">​</a></h3>
<p>Go to the config section: <code>search-index-typesense/config/</code></p>
<p>For manual entries in the search index, see <a href="https://github.com/WebOfTrust/keridoc/blob/main/search-index-typesense/config/config-search-index-entries-manual/README.md" target="_blank" rel="noopener noreferrer">this Readme</a></p>
<p>For manual created sitemaps, see <a href="https://github.com/WebOfTrust/keridoc/blob/main/search-index-typesense/config/config-sitemaps-exlude-urls/README.md" target="_blank" rel="noopener noreferrer">this Readme</a></p>
<p>For manual created sitemaps, see <a href="https://github.com/WebOfTrust/keridoc/blob/main/search-index-typesense/config/config-sitemaps-manual/README.md" target="_blank" rel="noopener noreferrer">this Readme</a></p>
<p>It is possible to override search index entries and give them prio in the search results.</p>
<p>Example:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;name&quot;: &quot;Diger&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;query&quot;: &quot;Diger&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;url&quot;: &quot;https://github.com/WebOfTrust/keripy/blob/main/src/keri/core/coring.py&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;position&quot;: 1,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;match&quot;: &quot;exact&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="background-info">Background info<a href="#background-info" class="hash-link" aria-label="Direct link to Background info" title="Direct link to Background info">​</a></h2>
<p>For who is this <em>how-we-did</em>: Maintainers of the KERISSE site</p>
<p>Why should you stick to this step by step: | @kordwarshuis ?? |</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="three-steps">Three steps<a href="#three-steps" class="hash-link" aria-label="Direct link to Three steps" title="Direct link to Three steps">​</a></h3>
<p>The creation of a search index for a website involves three steps:</p>
<ol>
<li>Decide which webpages (URLs) we want in our search index</li>
<li>Retrieve the content of the URLs (scraping)</li>
<li>Import the content into the Typesense search index</li>
</ol>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="1-decide-which-webpages-urls-we-want-in-our-search-index">1: Decide which webpages (URLs) we want in our search index<a href="#1-decide-which-webpages-urls-we-want-in-our-search-index" class="hash-link" aria-label="Direct link to 1: Decide which webpages (URLs) we want in our search index" title="Direct link to 1: Decide which webpages (URLs) we want in our search index">​</a></h4>
<p>You cannot be sent out to fetch something if they don&#x27;t tell you where to go. That is what a sitemap is for.</p>
<p>We have to create lists that contain all URLs that should be visited and scraped. These lists are called <em>sitemaps</em>.</p>
<p>A sitemap is a list of URLs. The most common format is XML.</p>
<p>There are three kinds of sitemaps we have to deal with:</p>
<ol>
<li>The sitemap.xml can be <strong>remote</strong>, that means, it is located at the domain that you will scrape, usually in the root, named “sitemap.xml”. It is also a source for search engines like Google and Bing.
If this is not present, we have to look further:</li>
<li>The remote sitemap can also be in the form of an <strong>HTML sitemap</strong>. This sitemap is meant for human visitors but can also be read by scrapers.
If this also does not exist, we have to create something ourselves:</li>
<li>The sitemap can be a local sitemap. Meaning: this sitemap is <strong>created by you</strong>, using a sitemap builder or manually.</li>
</ol>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="2-retrieve-the-content-of-the-urls-scraping">2: Retrieve the content of the URLs (scraping)<a href="#2-retrieve-the-content-of-the-urls-scraping" class="hash-link" aria-label="Direct link to 2: Retrieve the content of the URLs (scraping)" title="Direct link to 2: Retrieve the content of the URLs (scraping)">​</a></h4>
<p>The scraper uses the sitemaps as input and goes through all the URLs and indexes all paragraphs, lists, tables, code fragments, and saves it in JSONL (a special form of JSON) format.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="3-import-the-content-into-the-typesense-search-index">3: Import the content into the Typesense search index<a href="#3-import-the-content-into-the-typesense-search-index" class="hash-link" aria-label="Direct link to 3: Import the content into the Typesense search index" title="Direct link to 3: Import the content into the Typesense search index">​</a></h4>
<p>When all the URLs of a website (or multiple websites) have been scraped and captured in JSON, this JSON is imported into the search engine. The search engine we use is called <strong>Typesense</strong>, and the data is imported into their cloud solution.</p>
<p>In <strong>Typesense</strong> a “document” is what a “record” is in a database.</p>
<p>The documents we want to import have to follow a schema (<a href="https://typesense.org/docs/26.0/api/collections.html#with-pre-defined-schema" target="_blank" rel="noopener noreferrer">Example schema on the Typesense website</a>). We created our own schema for Kerisse.</p>
<p>More info on the <a href="https://typesense.org/docs/" target="_blank" rel="noopener noreferrer">Typesense website</a>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="more-detailed-steps">More detailed steps<a href="#more-detailed-steps" class="hash-link" aria-label="Direct link to More detailed steps" title="Direct link to More detailed steps">​</a></h3>
<ul>
<li>Test If Required Libraries Are Installed</li>
<li>Initializing<!-- -->
<ul>
<li>Get the directory where the main.sh script is located</li>
</ul>
</li>
<li>Preparing<!-- -->
<ul>
<li>Prepare file system. Remove old files and directories and create new ones.</li>
<li>Copy handmade stuff: entries for direct import into Typesense, manual files, sitemaps.</li>
<li>Create sitemaps via sitemap-generator.</li>
<li>Remove unwanted urls from the sitemaps (new sitemaps generated or not)</li>
<li>Filenames to lowercase.</li>
<li>Fetch external content from Google Sheets.</li>
</ul>
</li>
<li>Start Scraping<!-- -->
<ul>
<li>Scrape the websites.</li>
<li>Split the content.jsonl file into multiple files so the size is optimal for Typesense.</li>
<li>Count the total number of lines in all .jsonl files and write it to log dir.</li>
<li>Sort and style the index file.</li>
</ul>
</li>
<li>Backing Up<!-- -->
<ul>
<li>Backup output (scrape results, handmade stuff, sitemaps, logs, webpage overview, typesense export).</li>
</ul>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="software-used">Software used<a href="#software-used" class="hash-link" aria-label="Direct link to Software used" title="Direct link to Software used">​</a></h3>
<p>The following tools are used for scraping:</p>
<ul>
<li>Cheerio</li>
<li>Puppeteer</li>
</ul>
<p>“<a href="https://cheerio.js.org/" target="_blank" rel="noopener noreferrer">Cheerio can parse nearly any HTML or XML document. Cheerio works in both browser and server environments.</a>”</p>
<p>“<a href="https://pptr.dev/" target="_blank" rel="noopener noreferrer">Puppeteer is a Node.js library which provides a high-level API to control Chrome or Firefox over the DevTools Protocol or WebDriver BiDi. Puppeteer runs in the headless (no visible UI) by default but can be configured to run in a visible (&quot;headful&quot;) browser.</a>”</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="visualisation">Visualisation<a href="#visualisation" class="hash-link" aria-label="Direct link to Visualisation" title="Direct link to Visualisation">​</a></h3>
<img src="/keridoc/assets/images/scraping-1d8a5c98ffb43b69eb989d27171b175a.png" alt=""></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/WebOfTrust/keridoc/tree/main/docs/how-we-did/06_kerisse/create-search-index.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/keridoc/docs/how-we-did/kerific/kerific-discord-bot"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Kerific Discord bot</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/keridoc/docs/how-we-did/kerisse/ip-rights-scraping"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">IP rights of scraped sources</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#instructions-how-to-add-a-website-to-the-search-index" class="table-of-contents__link toc-highlight">Instructions: how to add a website to the search index</a><ul><li><a href="#sitemap" class="table-of-contents__link toc-highlight">Sitemap</a></li><li><a href="#scraper" class="table-of-contents__link toc-highlight">Scraper</a></li><li><a href="#import" class="table-of-contents__link toc-highlight">Import</a></li><li><a href="#additional-config-options" class="table-of-contents__link toc-highlight">Additional config options</a></li></ul></li><li><a href="#background-info" class="table-of-contents__link toc-highlight">Background info</a><ul><li><a href="#three-steps" class="table-of-contents__link toc-highlight">Three steps</a></li><li><a href="#more-detailed-steps" class="table-of-contents__link toc-highlight">More detailed steps</a></li><li><a href="#software-used" class="table-of-contents__link toc-highlight">Software used</a></li><li><a href="#visualisation" class="table-of-contents__link toc-highlight">Visualisation</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">General</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/keridoc/docs/intro/intro">Enter Documentation</a></li></ul></div><div class="col footer__col"><div class="footer__title">KERI Suite</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/keridoc/docs/intro/intro">KERIDoc</a></li><li class="footer__item"><a href="https://weboftrust.github.io/WOT-terms/" target="_blank" rel="noopener noreferrer" class="footer__link-item">KERIGlos<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://weboftrust.github.io/kerisse/" target="_blank" rel="noopener noreferrer" class="footer__link-item">KERISSE<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Important resources</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://docs.google.com/presentation/d/1lpzYcPrIox9V4hERtn4Kcf7uq01OVU9u3PuVm1aYzR0/edit#slide=id.ga411be7e84_0_0" target="_blank" rel="noopener noreferrer" class="footer__link-item">KERI for Muggles<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://keri.one/keri-resources/" target="_blank" rel="noopener noreferrer" class="footer__link-item">KERI Resources<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/SmithSamuelM/Papers/blob/master/whitepapers/KERI_WP_2.x.web.pdf" target="_blank" rel="noopener noreferrer" class="footer__link-item">KERI Whitepaper<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/weboftrust/keridoc" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://chromewebstore.google.com/detail/kerific/ckbmkbbmnfbeecfmoiohobcdmopekgmp" target="_blank" rel="noopener noreferrer" class="footer__link-item">Kerific Browser Extension<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div></div></footer></div>
</body>
</html>